{"version":3,"sources":["../../src/pages/login/login.module.ts","../../src/pages/login/login.ts"],"names":[],"mappings":"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","file":"35.js","sourcesContent":["/**\n * @license MIT\n * @version 1.1.0\n * @author M.A.R.S. Labs\n */\n\nimport { NgModule } from \"@angular/core\";\nimport { LoginPage } from \"./login\";\nimport { IonicPageModule } from \"ionic-angular\";\nimport { ComponentsModule } from \"@components/components.module\";\nimport { DirectivesModule } from \"@directives/directives.module\";\nimport { PipesModule } from \"@pipes/pipes.module\";\n\n@NgModule({\n  declarations: [LoginPage],\n  imports: [\n    IonicPageModule.forChild(LoginPage),\n    ComponentsModule,\n    DirectivesModule,\n    PipesModule\n  ],\n})\nexport class LoginPageModule { }\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.module.ts","/**\n * @license MIT\n * @version 1.1.0\n * @author M.A.R.S. Labs\n */\n\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, NgZone } from \"@angular/core\";\n\nimport { App, IonicPage, NavController, NavParams, Platform } from \"ionic-angular\";\n\nimport { Backend } from \"@backend/index\";\nimport * as querystring from \"query-string\";\n\nimport { AppGlobals } from \"@app/app.globals\";\nimport { AppLocales } from \"@app/app.locales\";\nimport { AppConstants } from \"@app/app.constants\";\n\nimport { MarsAuthService } from \"@services/auth.service\";\nimport { MarsInteractionService } from \"@services/interaction.service\";\n\nimport { MarsNavigationService } from \"@services/navigation.service\";\nimport { MarsOauthService } from \"@services/oauth.service\";\n\ndeclare var window: any;\ndeclare var hello: any;\n\n@IonicPage({\n    segment: \"auth/:package\"\n})\n@Component({\n    selector: \"page-login\",\n    templateUrl: \"login.html\",\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\n\nexport class LoginPage {\n\n    navigationService: MarsNavigationService;\n    translations: AppTranslations;\n\n    user: any = {};\n    confirmationCode: string;\n    package: string;\n    signupPage: string;\n    defaultOauthParams = { popup: { \"location\": \"no\" } };\n    facebookParams = Object.assign(this.defaultOauthParams, { scope: [\"_profile\", \"user_work_history\", \"email\"] });\n    linkedinParams = Object.assign(this.defaultOauthParams, { scope: [\"email\"] });\n    twitterParams = Object.assign(this.defaultOauthParams, { scope: [\"email\"] });\n\n    constructor(private navCtrl: NavController,\n        private navParams: NavParams,\n        private platform: Platform,\n        private app: App,\n        private zone: NgZone,\n        private changeDetector: ChangeDetectorRef,\n        private locales: AppLocales,\n        private globals: AppGlobals,\n        private interactionService: MarsInteractionService) {\n        this.navigationService = new MarsNavigationService(this.app);\n        this.navigationService.setNavCtrl(this.navCtrl);\n        this.translations = this.locales.load();\n    }\n\n    ionViewCanEnter() {\n        if (MarsAuthService.isLoggedIn())\n            return this.navigationService.canGoBack() ? this.navigationService.goBack : this.navigationService.setRoot('HomePage');\n    }\n\n    ionViewWillEnter() {\n        this.navParams.data.package = this.navParams.data.package || AppConstants.SUBPACKAGE || \"customer\";\n        this.package = this.navParams.data.package;\n        this.globals.package = this.navParams.data.package;\n        this.signupPage = `${this.package.toTitleCase()}BasicInformationPage`;\n        this.changeDetector.detectChanges();\n    }\n\n    ionViewDidEnter() {\n        if (this.platform.is(\"cordova\")) {\n            /* this.splashscreen.hide();\n            this.statusbar.show();\n            this.statusbar.styleLightContent();\n           this.statusbar.backgroundColorByHexString(AppConstants.DARKER_primary_color); */\n        }\n    }\n\n\n    async login() {\n        this.zone.run(async () => {\n            let spinner = this.interactionService.spinner({ content: this.translations.loading + \"...\" });\n            try {\n                let user = (await Backend.authenticateUser({ user: this.user })).data;\n                this.storeUserData(user);\n                if (user.signupStep == \"finished\") this.navigationService.setRoot('HomePage')\n                else this.navigationService.setRoot(user.signupStep);\n                /* let redirect = localStorage[MarsNavigationService.AUTH_PAGE_REDIRECT];\n                if (redirect) this.app.getActiveNav().push(redirect); */\n            } catch (e) {\n                this.interactionService.alert(this.translations.whoops_check_the_credentials_and_try_again)\n            } finally {\n                spinner.dismiss();\n                this.changeDetector.detectChanges();\n            }\n        });\n    }\n\n    goToSignupPage() {\n        if (this.package == \"merchant\") this.navigationService.setRoot(\"UserTypeInformationPage\");\n        else this.navigationService.setRoot(this.signupPage);\n    }\n\n    async accessWithFacebook() {\n        this.zone.run(async () => {\n            let spinner = this.interactionService.spinner({ content: this.translations.loading + \"...\" });\n            try {\n                hello.init({ facebook: AppConstants.FACEBOOK_CLIENT_ID }, { redirect_uri: AppConstants.OAUTH_REDIRECT });\n                let facebook = await hello.login(\"facebook\", this.facebookParams)\n                let access_token = facebook && facebook.authResponse && facebook.authResponse.access_token ? facebook.authResponse.access_token : undefined;\n                let data = (await Backend.accessWithFacebook({ accessToken: access_token })).data;\n                if (data.created) {\n                    this.globals.currentOauthUser = data.created;\n                    this.storeUserData(data.created);\n                    this.navigationService.goTo('CustomerBasicInformationPage');\n                } else {\n                    this.storeUserData(data);\n                    this.navigationService.goToRootPage();\n                }\n            } catch (e) {\n                if (e && e.status == 401) this.interactionService.alert(this.translations.error_duplicated_email);\n            } finally {\n                this.changeDetector.detectChanges();\n                spinner.dismiss();\n            }\n        });\n\n    }\n\n    storeUserData(user) {\n        console.log(user);\n        MarsAuthService.setLoggedInUser(user);\n        MarsAuthService.setMarsToken(user.token);\n    }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.ts"],"sourceRoot":""}