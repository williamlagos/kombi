import{a as e,b as t}from"./chunk-1c3f1b74.js";const s=window.localStorage;function n(e,t){return new Promise((n,o)=>{try{s&&s.setItem(e,JSON.stringify(t)),n()}catch(e){o(`Couldnt store object ${e}`)}})}function o(e){return new Promise((t,n)=>{try{s&&s.removeItem(e),t()}catch(e){n(`Couldnt remove object ${e}`)}})}function i(e){return new Promise((t,n)=>{try{if(s){const n=s.getItem(e);t(JSON.parse(n))}t(void 0)}catch(e){n(`Couldnt get object: ${e}`)}})}const a="localhost"===(window&&window.location&&window.location.hostname)?"http://localhost:3000":"https://api.shipping.net",r=(s,n)=>async(o,i)=>{if(e.setDomain(a),s.hasOwnProperty("files")){const t=s.files,o=(await(await e.addPicture({xAccessToken:n,files:t})).json()).map(e=>e._id)[0];await e.updateUser({xAccessToken:n,user:Object.assign({},s,{pictures:[o]})})}else await e.updateUser({xAccessToken:n,user:Object.assign({},s)});return o({type:t.UPDATE_PROFILE})},c=s=>async(n,o)=>{e.setDomain(a);const i=await(await e.getUserProfile({xAccessToken:s})).json();return i.pictures=i.hasOwnProperty("pictures")&&i.pictures.length>0?[(await(await e.getPicture({xAccessToken:s,id:i.pictures[0]})).json()).externalRef]:[],n({type:t.OPEN_PROFILE,profile:i})},p=(s,n)=>async(o,i)=>{e.setDomain(a);const r={user:{email:s,password:n}},c=await(await e.authenticateUser(r)).json();return(void 0).setItem("token",String(c.token)),o({directions:{component:"DRAWER",url:"/"},type:t.SET_TOKEN,token:c.token})},u=()=>(e,s)=>((void 0).removeItem("token"),e({directions:{component:"LOGIN",url:"/login"},type:t.REVOKE_TOKEN,token:""})),d=e=>async(s,n)=>((void 0).setItem("introduced",String(+e)),s({type:t.SKIP_INTRO,introduced:+e})),l=e=>async(s,n)=>((void 0).setItem("explained",String(+e)),s({directions:{component:"DRAWER",url:"/"},type:t.SKIP_TOUR,explained:+e})),m=()=>async(e,s)=>e({directions:{component:"REGISTER",url:"/register"},type:t.OPEN_REGISTER,registered:!1}),w=()=>async(e,s)=>e({directions:{component:"LOGIN",url:"/login"},type:t.CLOSE_REGISTER,registered:!0}),y=s=>async(n,o)=>{const i=s.files;console.log(s.files),e.setDomain(a);const r=await(await e.createUser({user:s})).json(),c=(await(await e.addPicture({xAccessToken:r.token,files:i})).json()).map(e=>e._id)[0];return await e.updateUser({xAccessToken:r.token,user:{pictures:[c]}}),n({type:t.CLOSE_REGISTER,registered:!0})},E=(e,s)=>async(n,o)=>{const i=o().session.directions.slice(-1)[0].component;return n({type:t.OPEN,directions:i===e?null:{component:e,url:s}})},g=()=>async(e,s)=>e({type:t.CLOSE,directions:{}});export{p as a,d as b,m as c,w as d,y as e,n as f,o as g,i as h,E as i,u as j,c as k,s as l,l as m,g as n,r as o};