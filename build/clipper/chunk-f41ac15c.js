import{g as s,h as a,i as e}from"./chunk-fe10219c.js";const t=new class{constructor(){this.favorites=new Set}hasFavorite(s){return this.favorites.has(s)}addFavorite(s){this.favorites.add(s)}removeFavorite(s){this.favorites.delete(s)}async login(a){await s("hasLoggedIn",!0),await this.setUsername(a),window.dispatchEvent(new Event("user:login"))}async signup(a){await s("hasLoggedIn",!0),await this.setUsername(a),window.dispatchEvent(new Event("user:signup"))}async logout(){await a("hasLoggedIn"),await a("username"),window.dispatchEvent(new Event("user:logout"))}async setUsername(a){await s("username",a)}async getUsername(){return e("username")}async isLoggedIn(){return!0===await e("hasLoggedIn")}async hasSeenTutorial(a){return s("hasSeenTutorial",a)}async checkHasSeenTutorial(){return!!await e("hasSeenTutorial")}},r=new class{constructor(s){this.user=s}async load(){if(this.data)return this.data;{const s=await fetch("/assets/data/data.json"),a=await s.json();return this.processData(a)}}processData(s){return this.data=s,this.data.tracks=[],this.data.schedule.forEach(s=>{s.groups.forEach(s=>{s.sessions.forEach(s=>{s.speakers=[],s.speakerNames&&s.speakerNames.forEach(a=>{const e=this.data.speakers.find(s=>s.name===a);e&&(s.speakers.push(e),e.sessions=e.sessions||[],e.sessions.push(s))}),s.tracks&&s.tracks.forEach(s=>{this.data.tracks.indexOf(s)<0&&this.data.tracks.push(s)})})})}),this.data}async getTimeline(s,a="",e=[],t="all"){const r=(await this.load()).schedule[s];r.shownSessions=0;const n=(a=a.toLowerCase().replace(/,|\.|-/g," ")).split(" ").filter(s=>!!s.trim().length);return r.groups.forEach(s=>{s.hide=!0,s.sessions.forEach(a=>{this.filterSession(a,n,e,t),a.hide||(s.hide=!1,r.shownSessions++)}),this.mapFavorites(s.sessions)}),r}mapFavorites(s){s.map(s=>{s.isFavorite=this.user.hasFavorite(s.name)})}async getSession(s){const a=await this.load();for(const e of a.schedule)for(const a of e.groups)for(const e of a.sessions)if(e.id===s)return e;return null}filterSession(s,a,e,t){let r=!1;a.length?a.forEach(a=>{s.name.toLowerCase().indexOf(a)>-1&&(r=!0)}):r=!0;let n=!1;s.tracks.forEach(s=>{-1===e.indexOf(s)&&(n=!0)});let i=!1;"favorites"===t?this.user.hasFavorite(s.name)&&(i=!0):i=!0,s.hide=!(r&&n&&i)}async getSpeakers(){return(await this.load()).speakers.sort((s,a)=>{const e=s.name.split(" ").pop(),t=a.name.split(" ").pop();return e.localeCompare(t)})}async getSpeaker(s){const a=await this.load();for(const e of a.speakers)if(e.id===s)return e;return null}async getTracks(){return(await this.load()).tracks.sort()}async getMap(){return(await this.load()).map}}(t);export{r as a,t as b};