var __awaiter=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function c(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(c,u)}s((r=r.apply(e,n||[])).next())})},__generator=this&&this.__generator||function(e,n){var t,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};clipper.loadBundle("chunk-62ac0f7b.js",["exports","./chunk-ea768d49.js"],function(e,n){var t=this,r=(window,localStorage||window.localStorage),o="localhost"===(window&&window.location&&window.location.hostname)?"http://localhost:3000":"https://wasserboxer.herokuapp.com";e.close=function(){return function(e,r){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){return[2,e({type:n.TypeKeys.CLOSE,directions:{}})]})})}},e.setToken=function(e,i){return function(c,u){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(u){switch(u.label){case 0:return n.Backend.setDomain(o),[4,n.Backend.authenticateUser({user:{email:e,password:i}})];case 1:return[4,u.sent().json()];case 2:return t=u.sent(),r.setItem("token",String(t.token)),[2,c({directions:{component:"DRAWER",url:"/"},type:n.TypeKeys.SET_TOKEN,token:t.token})]}})})}},e.toggleIntro=function(e){return function(o,i){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){return r.setItem("introduced",String(+e)),[2,o({type:n.TypeKeys.SKIP_INTRO,introduced:+e})]})})}},e.openRegister=function(){return function(e,r){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){return[2,e({directions:{component:"REGISTER",url:"/register"},type:n.TypeKeys.OPEN_REGISTER,registered:!1})]})})}},e.closeRegister=function(){return function(e,r){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){return[2,e({directions:{component:"LOGIN",url:"/login"},type:n.TypeKeys.CLOSE_REGISTER,registered:!0})]})})}},e.register=function(e){return function(r,i){return __awaiter(t,void 0,void 0,function(){var t,i,c,u;return __generator(this,function(s){switch(s.label){case 0:return t=e.files,console.log(e.files),n.Backend.setDomain(o),[4,n.Backend.createUser({user:e})];case 1:return[4,s.sent().json()];case 2:return i=s.sent(),[4,n.Backend.addPicture({xAccessToken:i.token,files:t})];case 3:return[4,s.sent().json()];case 4:return c=s.sent(),u=c.map(function(e){return e._id})[0],[4,n.Backend.updateUser({xAccessToken:i.token,user:{pictures:[u]}})];case 5:return s.sent(),[2,r({type:n.TypeKeys.CLOSE_REGISTER,registered:!0})]}})})}},e.set=function(e,n){return new Promise(function(t,o){try{r&&localStorage.setItem(e,JSON.stringify(n)),t()}catch(e){o("Couldnt store object "+e)}})},e.remove=function(e){return new Promise(function(n,t){try{r&&localStorage.removeItem(e),n()}catch(e){t("Couldnt remove object "+e)}})},e.get=function(e){return new Promise(function(n,t){try{if(r){var o=localStorage.getItem(e);n(JSON.parse(o))}n(void 0)}catch(e){t("Couldnt get object: "+e)}})},e.open=function(e,r){return function(o,i){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(c){return t=i().session.directions.slice(-1)[0].component,[2,o({type:n.TypeKeys.OPEN,directions:t===e?null:{component:e,url:r}})]})})}},e.revokeToken=function(){return function(e,t){return r.removeItem("token"),e({directions:{component:"LOGIN",url:"/login"},type:n.TypeKeys.REVOKE_TOKEN,token:""})}},e.openProfile=function(e){return function(r,i){return __awaiter(t,void 0,void 0,function(){var t,i,c;return __generator(this,function(u){switch(u.label){case 0:return n.Backend.setDomain(o),[4,n.Backend.getUserProfile({xAccessToken:e})];case 1:return[4,u.sent().json()];case 2:return t=u.sent(),i=t,t.hasOwnProperty("pictures")&&t.pictures.length>0?[4,n.Backend.getPicture({xAccessToken:e,id:t.pictures[0]})]:[3,5];case 3:return[4,u.sent().json()];case 4:return c=[u.sent().externalRef],[3,6];case 5:c=[],u.label=6;case 6:return i.pictures=c,[2,r({type:n.TypeKeys.OPEN_PROFILE,profile:t})]}})})}},e.Storage=r,e.toggleTour=function(e){return function(o,i){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){return r.setItem("explained",String(+e)),[2,o({directions:{component:"DRAWER",url:"/"},type:n.TypeKeys.SKIP_TOUR,explained:+e})]})})}},e.updateProfile=function(e,r){return function(i,c){return __awaiter(t,void 0,void 0,function(){var t,c;return __generator(this,function(u){switch(u.label){case 0:return n.Backend.setDomain(o),e.hasOwnProperty("files")?[4,n.Backend.addPicture({xAccessToken:r,files:e.files})]:[3,4];case 1:return[4,u.sent().json()];case 2:return t=u.sent(),c=t.map(function(e){return e._id})[0],[4,n.Backend.updateUser({xAccessToken:r,user:Object.assign({},e,{pictures:[c]})})];case 3:return u.sent(),[3,6];case 4:return[4,n.Backend.updateUser({xAccessToken:r,user:Object.assign({},e)})];case 5:u.sent(),u.label=6;case 6:return[2,i({type:n.TypeKeys.UPDATE_PROFILE})]}})})}}});