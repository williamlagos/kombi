import{r as t,g as i}from"./p-5a3a7011.js";import{p as e}from"./p-30d77a1e.js";import{a as o,b as s}from"./p-1ebc0f64.js";import{i as n}from"./p-011655de.js";import"./p-65d8e78f.js";const l=class{constructor(i){t(this,i),this.data={value:0,description:""}}async componentWillLoad(){this.store.mapStateToProps(this,(t=>{const{session:{token:i},customer:{bids:e}}=t;return{token:i,bids:e}})),this.store.mapDispatchToProps(this,{placeOrder:e,showOrderBids:o,selectMerchantForOrder:s,close:n}),await this.showOrderBids(this.token,this.orderId)}async dismiss(t){this.el.closest("ion-modal").dismiss(null===t?{success:0}:t),(await this.tab.componentOnReady()).select("tab-drawer"),this.close()}offer(){console.log(this.order._id),console.log(this.orderId);const t=Object.assign(Object.assign({},this.data),{user:this.userId});this.placeOrder(t,this.orderId,this.token),this.dismiss({success:0})}schedule(){const t=document.querySelector("#merchants");this.selectMerchantForOrder(t.value,this.orderId,this.token),this.dismiss({success:0})}handleInput(t){t.preventDefault(),this.data[t.target.name]="description"!==t.target.name?+t.target.value:t.target.value}render(){const t=this.config.get("mode");return[h("ion-header",null,h("ion-toolbar",null,h("ion-buttons",{slot:"md"===t?"end":"start"},h("ion-button",{onClick:()=>this.dismiss()},"Cancelar")),h("ion-title",null,this.order.title))),h("ion-content",{class:"outer-content"},h("ion-grid",null,h("ion-row",null,h("ion-col",{style:{"text-align":"center"},"col-10":!0,"push-1":!0,"col-sm-6":!0,"push-sm-3":!0},h("ion-item",null,this.order.hasOwnProperty("pictures")&&this.order.pictures.length>0?h("img",{style:{"text-align":"center",margin:"10px 10px 10px 0px"},src:this.order.pictures[0].externalRef,alt:"Aqui fica a imagem do pedido"}):h("img",{style:{"text-align":"center",margin:"10px 10px 10px 0px"},alt:"Aqui fica a imagem do pedido"}),h("ion-label",{style:{"text-align":"left"}},h("p",null,"Origem: ",this.order.job.origin.address.street+", "+this.order.job.origin.address.number),h("p",null,"Destino: ",this.order.job.destination.address.street+", "+this.order.job.destination.address.number),h("p",null,this.order.job.origin.items.length>1?h("ion-list",null,this.order.job.origin.items.map((t=>h("ion-item",null,t.description)))):this.order.job.origin.items.length>0&&this.order.job.origin.items[0].description))))),h("ion-row",null,h("ion-col",null,"MERCHANT"===this.role?h("form",{style:{width:"100%"}},h("ion-item",null,h("ion-label",null,"Média de preço ofertada: ",Math.round(100*(this.bids.length>0?this.bids.reduce(((t,i)=>t.value+i.value))/this.bids.length:0))/100)),h("ion-item",null,h("ion-label",{position:"stacked",color:"primary"},"Digite uma observação"),h("ion-textarea",{name:"description",value:"",onInput:t=>this.handleInput(t)})),h("ion-item",null,h("ion-label",{position:"stacked",color:"primary"},"Digite o valor desejado"),h("ion-input",{name:"value",type:"number",value:"",onInput:t=>this.handleInput(t)})),h("ion-button",{expand:"full",color:"primary",onClick:()=>this.offer(),fill:"clear"},"Ofertar")):h("ion-list",null,h("ion-radio-group",{id:"merchants"},h("ion-list-header",null,h("ion-label",null,"Selecione a oferta de um freteiro:")),this.bids.map(((t,i)=>h("ion-item",null,h("ion-label",null,t.user.name," ofereceu R$ ",t.value),h("ion-radio",{slot:"start",value:t.user._id,checked:0===i}))))),h("ion-button",{expand:"block",onClick:()=>this.schedule()},"Agendar frete"))))))]}get el(){return i(this)}};l.style="page-order-detail ion-card{text-align:center}page-order-detail img{max-width:140px;margin:0 auto 20px;}page-order-detail p{color:#60646b}.outer-content{display:flex;align-items:center;justify-content:center}";export{l as page_order_detail}