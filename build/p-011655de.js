import{B as e,T as t}from"./p-65d8e78f.js";const n=window.localStorage,s=n;function o(e,t){return new Promise(((s,o)=>{try{n&&n.setItem(e,JSON.stringify(t)),s()}catch(e){o(`Couldnt store object ${e}`)}}))}function c(e){return new Promise(((t,s)=>{try{n&&n.removeItem(e),t()}catch(e){s(`Couldnt remove object ${e}`)}}))}function i(e){return new Promise(((t,s)=>{try{if(n){const s=n.getItem(e);t(JSON.parse(s))}t(void 0)}catch(e){s(`Couldnt get object: ${e}`)}}))}const a="localhost"===(window&&window.location&&window.location.hostname)?"http://localhost:3000":"https://api.shipping.net",r=(n,s)=>async o=>{if(e.setDomain(a),n.hasOwnProperty("files")){const t=n.files,o=(await(await e.addPicture({xAccessToken:s,files:t})).json()).map((e=>e._id))[0];await e.updateUser({xAccessToken:s,user:Object.assign(Object.assign({},n),{pictures:[o]})})}else await e.updateUser({xAccessToken:s,user:Object.assign({},n)});return o({type:t.UPDATE_PROFILE})},p=n=>async s=>{e.setDomain(a);const o=await(await e.getUserProfile({xAccessToken:n})).json();return o.pictures=o.hasOwnProperty("pictures")&&o.pictures.length>0?[(await(await e.getPicture({xAccessToken:n,id:o.pictures[0]})).json()).externalRef]:[],s({type:t.OPEN_PROFILE,profile:o})},u=(n,o)=>async c=>{e.setDomain(a);const i={user:{email:n,password:o}},r=await(await e.authenticateUser(i)).json();return s.setItem("token",String(r.token)),c({directions:{component:"DRAWER",url:"/"},type:t.SET_TOKEN,token:r.token})},d=()=>e=>(s.removeItem("token"),e({directions:{component:"LOGIN",url:"/login"},type:t.REVOKE_TOKEN,token:""})),w=e=>async n=>(s.setItem("introduced",String(+e)),n({type:t.SKIP_INTRO,introduced:+e})),l=e=>async n=>(s.setItem("explained",String(+e)),n({directions:{component:"DRAWER",url:"/"},type:t.SKIP_TOUR,explained:+e})),y=()=>async e=>e({directions:{component:"REGISTER",url:"/register"},type:t.OPEN_REGISTER,registered:!1}),m=()=>async e=>e({directions:{component:"LOGIN",url:"/login"},type:t.CLOSE_REGISTER,registered:!0}),f=n=>async s=>{const o=n.files;console.log(n.files),e.setDomain(a);const c=await(await e.createUser({user:n})).json(),i=(await(await e.addPicture({xAccessToken:c.token,files:o})).json()).map((e=>e._id))[0];return await e.updateUser({xAccessToken:c.token,user:{pictures:[i]}}),s({type:t.CLOSE_REGISTER,registered:!0})},g=(e,n)=>async(s,o)=>{const c=o().session.directions.slice(-1)[0].component;return s({type:t.OPEN,directions:c===e?null:{component:e,url:n}})},k=()=>async e=>e({type:t.CLOSE,directions:{}});export{s as S,g as a,y as b,m as c,f as d,l as e,o as f,c as g,i as h,k as i,p as o,d as r,u as s,w as t,r as u}