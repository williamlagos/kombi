import{r as t}from"./p-5a3a7011.js";import{P as i}from"./p-5c860674.js";import{a as o}from"./p-30d77a1e.js";import{s as e}from"./p-1ebc0f64.js";import"./p-65d8e78f.js";const{Browser:s}=i,r=class{constructor(i){t(this,i),this.speakers=[],this.orders=[],this.orderNumberStart=0,this.orderNumberEnd=12}async componentWillLoad(){this.store.mapStateToProps(this,(t=>{const{session:{token:i}}=t;return{token:i}})),this.role=this.parseJwt(this.token)._role,"MERCHANT"===this.role?(this.store.mapStateToProps(this,(t=>{const{merchant:{orders:i}}=t;return{orders:i}})),this.store.mapDispatchToProps(this,{showOrder:o}),await this.showOrder(this.token)):"CUSTOMER"===this.role&&(console.log("YES"),this.store.mapStateToProps(this,(t=>{const{customer:{orders:i}}=t;return{orders:i}})),this.store.mapDispatchToProps(this,{showMyOrders:e}),await this.showMyOrders(this.token))}goToSpeakerTwitter(t){console.log("goToSpeakerTwitter",t),s.open({url:`https://twitter.com/${t.twitter}`})}async openSpeakerShare(t){(await this.actionSheetCtrl.create({header:"Share "+t.name,buttons:[{text:"Copy Link",handler:()=>{console.log("Copy link clicked on https://twitter.com/"+t.twitter),window.cordova&&window.cordova.plugins.clipboard&&window.cordova.plugins.clipboard.copy("https://twitter.com/"+t.twitter)}},{text:"Share via ..."},{text:"Cancel",role:"cancel"}]})).present()}async openContact(t){const i=this.mode;(await this.actionSheetCtrl.create({header:"Contact "+t.name,buttons:[{text:`Email ( ${t.email} )`,icon:"ios"!==i?"mail":null,handler:()=>{window.open("mailto:"+t.email)}},{text:`Call ( ${t.phone} )`,icon:"ios"!==i?"call":null,handler:()=>{window.open("tel:"+t.phone)}}]})).present()}parseJwt(t){const i=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(window.atob(i))}async offer(t,i){const o=await this.modalCtrl.create({component:"page-order-detail",componentProps:{role:this.role,userId:this.parseJwt(this.token)._id,orderId:t.target.id,order:i}});await o.present();const{data:e}=await o.onDidDismiss();0===e.success&&(t.target.disabled=!0)}previousOrders(){this.orderNumberStart-=12,this.orderNumberEnd-=12}nextOrders(){this.orderNumberStart+=12,this.orderNumberEnd+=12}render(){const t=this.orders.reverse().slice(this.orderNumberStart,this.orderNumberEnd);return[h("ion-header",null,h("ion-toolbar",null,h("ion-buttons",{slot:"start"},h("ion-menu-button",null)),h("ion-title",null,"Ofertar"))),h("ion-content",{class:"outer-content"},h("ion-list",null,h("ion-grid",{fixed:!0},h("ion-row",{"align-items-stretch":!0},this.orders.length>12&&[h("ion-button",{fill:"clear",disabled:0===this.orderNumberStart,onClick:()=>this.previousOrders()},"Anterior"),h("ion-button",{fill:"clear",disabled:this.orderNumberEnd>=this.orders.length,onClick:()=>this.nextOrders()},"Próximo")],t.map((t=>"created"===t.status&&h("ion-col",{size:"12","size-md":"6"},h("ion-card",{class:"speaker-card"},h("a",{style:{"text-decoration":"none"},href:`/speakers/${t.id}`},h("img",{style:{"text-align":"center"},src:t.hasOwnProperty("pictures")&&t.pictures.length>0?t.pictures[0].externalRef:"assets/img/box.svg",alt:"Aqui fica a imagem do pedido"})),h("ion-card-header",null,h("ion-card-subtitle",null,t.job.origin.address.street+", "+t.job.origin.address.number),h("ion-card-title",null,t.title)),h("ion-card-content",null,t.job.origin.items.length>1?h("ion-list",null,t.job.origin.items.map((t=>h("ion-item",null,t.description)))):t.job.origin.items.length>0&&t.job.origin.items[0].description),"MERCHANT"===this.role?h("ion-button",{id:t._id,expand:"full",color:"primary",disabled:t.placed,fill:"clear",onClick:i=>this.offer(i,t)},t.placed?"Frete já ofertado":"Ofertar"):h("ion-button",{id:t._id,expand:"full",color:"primary",disabled:t.placed,fill:"clear",onClick:i=>this.offer(i,t)},t.placed?"Frete já selecionado":"Ver ofertas")))))))))]}};r.style=".speaker-card a img{border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-left-radius:0px;border-bottom-right-radius:0px}";export{r as page_order_list}